# ALS Implicit Collaborative Filtering

## Обзор

Мы напишем простую реализацию неявного рекомендательного алгоритма. Мы хотим находить похожие позиции и делать рекомендации нашим пользователям. Я сфокусируюсь на теории, некоторой части математики и на реализации python кода.

Так как мы разгоавриваем на тему коллаборативной фильтрации, то нас беспокоют только позиции (товары, к примеру), пользователи и то, как пользователи взаимодействуют с позициями.

## Неявные / Явные данные

В нашем случае явные данные это то, к примеру, какую оценку пользователи поставили фильмам в датасетах MovieLens или Netflix. То есть это нечто наподобие рейтинга. Мы знаем, как сильно пользователям нравится или не нравится позиция (к примеру, фильм). Иметь такого рода данные очень замечательно, но их непросто собрать или найти. Многие пользователи предпочитают не тратить время на расстановку рейтингов.

Неявные данные извлекаются из поведения пользователей, без расставления рейтингов или каких либо действий. Это могут быть данные рода: какие товары пользователь купил, как много раз пользователь прослушал / просмотрел ту или иную песню / фильм, как много времени пользователь потратил времени на прочтение той или иной статьи. Плюс - больше данных, минус - они шумные и не всегда соответствуют тому, что они действительно означают.

К примеру, с рейтингом мы знаем, что если пользователь поставил рейтинг 1, то это значит, что фильм пользователю не понравился. Если 5, то понравился. В случае с прослушанной песней факт того, что пользователь прослушал ее это не обязательно значит что она ему понравилась. А если песня не была прослушана, то это также не значит, что она пользователю не подходит, так как он попросту мог и не знать о ней.

Поэтому мы фокусируемся на том, что нам известно - на действия пользователя, и на нашей уверенности в том, нравится ему тот или иной товар, или нет. Мы можем, например, измерить, как часто он воспроизводит песню, и дать более высокую степень уверенности, если он прослушали ее 500 раз по сравнению с одним разом.

Неявные рекомендации занимают все большую часть рекомендательных систем, т.к. размер неявных данных растет. К примеру, изначальное соревнование NetFlix базировалось только на явных данных, но сейчас они все больше и больше базируются на неявных данных. То же самое происходит и с Hulu, Spotify, Etsy и т.д..

## Датасет

В рамках данной статьи мы будем использовать датасет lastfm, содержащий поведение более чем 360,000 пользователей. Датасет содержит ID пользователя, ID артиста, имя артиста и сколько раз данный пользователь прослушал данного артиста. Также имеется информаци о возрасте, поле, стране и т.д. для пользователя. Но сейчас эту информацию мы не будем использовать.

## Alternating Least Squares (ALS)

ALS это модель, которую мы будем использовать для настройки на наших данных и для поиска схожести. Но перед этим повторим азы - разложение матриц. Именно на этом и основывается алгоритм ALS.

### Разложение матриц

Идея основывается на том, чтобы взять большую матрицу (потенциально огромную) и разложить ее в более сжатое представление. Таким образом мы получим две матрицы меньших размерностей, чье произведение равно исходной матрице.

